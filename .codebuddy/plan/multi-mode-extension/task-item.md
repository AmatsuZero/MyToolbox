# 实施计划

本文档基于需求文档，列出了实现命令行工具双模式扩展（Whisper 字幕提取 + Mimic3 语音训练）的具体编码任务。

---

- [ ] 1. 重构命令行接口支持双模式切换
   - 修改 `cli_interface.py` 中的 `_setup_parser()` 方法，添加 `--whisper` 和 `--train` 互斥参数组
   - 添加模式参数验证逻辑，确保两个模式互斥
   - 更新帮助文档，清晰描述两种模式的使用方法
   - _需求：1.1、1.2、1.3、1.4、1.5_

- [ ] 2. 创建训练模式的配置模块
   - 创建 `train_config.py` 文件，定义 `TrainConfig` 数据类
   - 包含训练参数：epochs、batch_size、sample_rate、speaker_name、output_path
   - 实现配置文件加载和默认值管理
   - _需求：5.1、5.2、5.3、5.4、5.5、5.6_

- [ ] 3. 实现 Mimic3 依赖检查模块
   - 创建 `mimic3_checker.py` 文件，实现 Mimic3 安装检测功能
   - 添加版本兼容性验证逻辑
   - 提供安装指引和错误提示信息
   - _需求：7.1、7.2、7.3、7.4、7.5_

- [ ] 4. 创建训练数据管理模块
   - 创建 `train_data_manager.py` 文件，实现训练数据扫描和管理
   - 支持从目录批量扫描视频、音频、字幕文件
   - 实现音频与字幕文件的自动匹配（基于文件名）
   - 支持从视频文件提取音频用于训练
   - _需求：3.1、3.2、3.3、4.1、4.2、4.3、4.5、4.6_

- [ ] 5. 实现音频-字幕对齐处理器
   - 创建 `audio_aligner.py` 文件，实现音频片段与文本标签的对齐
   - 解析字幕文件时间戳，切分音频为训练片段
   - 生成符合 Mimic3 训练格式的数据集结构
   - _需求：3.4_

- [ ] 6. 集成 Whisper 自动生成字幕功能
   - 在训练数据管理模块中集成现有 Whisper 功能
   - 当用户仅提供视频/音频而无字幕时，自动调用 Whisper 生成字幕
   - 确保生成的字幕可直接用于训练数据准备
   - _需求：4.4_

- [ ] 7. 实现 Mimic3 训练接口封装
   - 创建 `mimic3_trainer.py` 文件，封装 Mimic3 训练 API
   - 实现训练参数配置和模型输出管理
   - 添加训练进度回调和状态监控
   - _需求：3.5、3.6_

- [ ] 8. 实现训练进度与结果报告系统
   - 在 `mimic3_trainer.py` 中添加训练进度显示功能
   - 实现训练数据统计信息输出（音频时长、片段数量等）
   - 生成训练完成后的摘要报告（耗时、损失值、模型大小）
   - 支持 `--verbose` 参数输出详细日志
   - _需求：6.1、6.2、6.3、6.4、6.5_

- [ ] 9. 创建训练模式主控制器
   - 创建 `train_controller.py` 文件，整合训练流程
   - 协调数据管理、对齐处理、Mimic3 训练各模块
   - 实现完整的训练工作流：数据准备 → 对齐 → 训练 → 输出
   - _需求：3.1-3.6、4.1-4.6、5.1-5.6、6.1-6.5_

- [ ] 10. 整合双模式到主程序入口
   - 修改 `main.py`，根据命令行参数分发到对应模式
   - Whisper 模式：调用现有 `CLIInterface` 和 `SpeechToTextSystem`
   - Train 模式：调用新增的 `TrainController`
   - 确保两种模式完全独立运行，互不影响
   - _需求：1.1、1.2、2.1-2.5_
